# final_practice
Sprint 2 - Kafka Main Task

---

## Описание проекта

Проект состоит из одного продюсера и двух типов консьюмеров для Apache Kafka.  
Продюсер отправляет сообщения в топик, а консьюмеры читают их с разной стратегией обработки.

### Классы и структура:
- `cmd/producer/main.go` – продюсер, отправляющий сообщения в Kafka-топик.
- `cmd/consumer_single/main.go` – консьюмер, обрабатывающий по одному сообщению (SingleMessageConsumer).
- `cmd/consumer_batch/main.go` – консьюмер, обрабатывающий пачками от 10 сообщений (BatchMessageConsumer).
- `config/config.go` – файл с конфигурацией подключения к Kafka.
- `model/product.go` – структура сообщения `Product`, отправляемого в Kafka.
- `topic_manager/topic_manager.go` – функции для работы с топиками (создание топика).

## Инструкция по запуску

1. Убедитесь, что у вас установлен `docker` и `docker-compose`.
2. Выполните команду:

    ```bash
    docker compose up --build
    ```

3. Сервисы, которые поднимутся:
    - Кластер Kafka на основе Bitnami образов (`kafka-0`, `kafka-1`, `kafka-2`).
    - Автоматическое создание топика `products`.
    - Приложение-продюсер.
    - Два инстанса SingleMessageConsumer.
    - Два инстанса BatchMessageConsumer.
    - Kafka UI для визуализации сообщений.

4. Откройте браузер и перейдите на `http://localhost:8080`, чтобы зайти в Kafka UI и увидеть сообщения.

## Принцип работы

- Продюсер каждые 3 секунды отправляет новые сообщения о продуктах в топик `products`.
- SingleMessageConsumer:
    - Читает по одному сообщению.
    - Автоматически коммитит оффсеты.
- BatchMessageConsumer:
    - Читает минимум по 10 сообщений за раз.
    - Обрабатывает их в цикле.
    - После обработки пачки вручную коммитит оффсет.

## Проверка задания

- Сообщения регулярно появляются в Kafka UI в топике `products`.
- Продюсер пишет сообщения без ошибок.
- SingleMessageConsumer обрабатывает сообщения по одному.
- BatchMessageConsumer обрабатывает минимум 10 сообщений за раз.
- Все приложения продолжают работать даже при временных ошибках сети.
- Используется сериализация и десериализация структуры `Product`.
- Настроены гарантии доставки в продюсере (`acks=all`, `retries > 0`).

---
